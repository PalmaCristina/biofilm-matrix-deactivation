% Generated by Palma,C on 22.05.2025
------------------------------------------------------------------------------------------
%% To GENERATE FIGURE FROM SAVED RESULTS

-> Run script 'Rates_bar_plot.m'


%% TO GENERATE FIGURE FROM SCRATCH

% NOTE: This folder is similar to Figure 3 and Figure S3 folder. The only difference in that:

->In folder '00 Stochasticity' includes stochasticity in cell cycle dynamics and binomial partition of cell contents.
->In folder '01 No_Stochasticity' includes binomial partition of cell contents and no stochasticity.

Inside of each of these folders there are sub-folders:

01 Activation folder: Runs 1000 stochastic simulations. Each simulation starts in an 'OFF state' generated stochastically. 
02 Deactivation folder: Runs 1000 stochastic simulations. Each simulation starts in an 'ON state' generated stochastically. 
03 Fit simultaneously: Fits theoretical probability equations to the stochastic simulation results;

To reproduce Figure S4 follow the steps below for folder '00 Stochasticity' and '01 No_Stochasticity':

In Activation folder:
---01 Run script 'Run_several_cells_03'
---02 Results will be saved in files 'Constant_Activation_04' and 'Activation_04'
---03 Next, save those results in 'Results' folder. 
---04 In 'results folder' run 'Calculate_Probabilities_02' 
---05 Results will be saved in files 'DATA_C_ACTIVATION' and 'DATA_O_ACTIVATION' 

In Deactivation folder:

---01 Run script 'Run_several_cells_02'
---02 Results will be saved in files 'Constant_Deactivation_04' and 'Deactivation_04'
---03 Next, save those results in 'Results'. 
---04 In 'results folder' run 'Calculate_Probabilities_04' 
---05 Results will be saved in files 'DATA_C_DEACTIVATION' and 'DATA_O_DEACTIVATION' 

In Fit simultaneously folder:

---01 Copy files 'DATA_C_ACTIVATION', 'DATA_O_ACTIVATION','DATA_C_DEACTIVATION' and 'DATA_O_DEACTIVATION' to folder 'Fit simultaneously' and run 'Fit_simultaneouly' script. 
--- Save the estimated rate constants. 
--- Update and run 'Rates_bar_plot.m' script with the estimated rate constants (line 2 and 3)
